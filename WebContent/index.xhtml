<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:m="http://code.google.com/p/gmaps4jsf/"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:fb="http://www.facebook.com/2008/fbml"
	lang="en" class="googlemapstyle unselectable">
  <head>
  
  	<f:metadata>
		<f:event type="preRenderView" listener="#{indexRedirect.redirect}"/>
	</f:metadata>
  	
	<!-- Disable cacheing in all browsers -->
	<meta http-equiv="cache-control" content="max-age=0" />
	<meta http-equiv="cache-control" content="no-cache" />
	<meta http-equiv="expires" content="0" />
	<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
	<meta http-equiv="pragma" content="no-cache" />
	
	<meta charset="utf-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
	<meta name="description" content=""/>
	<meta name="author" content=""/>
	<link rel="icon" href="image/favicon.ico"/>
	
	<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAw6MYzh9A5OP3plRY0BmxxjIrQ7UCMaOQ&amp;sensor=true"></script>
	
    <title>Pinder</title>

    <!-- Bootstrap core CSS -->
    <link href="./css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom styles for this template -->
    <link href="/css/cover.css" rel="stylesheet"/>

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="./js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="./js/ie-emulation-modes-warning.js"></script>

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="./js/ie10-viewport-bug-workaround.js"></script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.1/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
  
  		<!-- Carousel================================================== -->
	    <div id="myCarousel" class="carousel slide" data-ride="carousel">
    
	      <!-- Indicators -->
	      <ol class="carousel-indicators">
	        <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
	        <li data-target="#myCarousel" data-slide-to="1"></li>
	        <li data-target="#myCarousel" data-slide-to="2"></li>
	      </ol>
	      <div class="carousel-inner">
	        <div class="item active" style="background-image: url('http://www.wallpaperup.com/uploads/wallpapers/2013/07/18/120028/57a933d7e6c9c206b45e4d3aa0319955.jpg');">
	        </div>
	        <div class="item" style="background-image: url('http://www.mrstyleking.com/wp-content/uploads/2013/07/partygay.jpg');">
	        </div>
	        <div class="item" style="background-image: url('http://www.world-wallpaper.com/user-content/uploads/wall/o/36/Singapore-New-Year-Wallpaper.jpg');">
	        </div>
	        <div class="item" style="background-image: url('http://theremarkabletraveller.files.wordpress.com/2013/08/img_6888.jpg');">
	        </div>
	      </div>

<!-- 	      <a class="left carousel-control" href="#myCarousel" data-slide="prev"><span class="glyphicon glyphicon-chevron-left"></span></a> -->
<!-- 	      <a class="right carousel-control" href="#myCarousel" data-slide="next"><span class="glyphicon glyphicon-chevron-right"></span></a> -->
	      
	    </div><!-- /.carousel -->
	    
		<script>
		  // This is called with the results from from FB.getLoginStatus().
		  function statusChangeCallback(response) {
		    console.log('statusChangeCallback');
		    console.log(response);
		    // The response object is returned with a status field that lets the
		    // app know the current login status of the person.
		    // Full docs on the response object can be found in the documentation
		    // for FB.getLoginStatus().
		    if (response.status === 'connected') {
		      // Logged into your app and Facebook.
		      testAPI();
		    } else if (response.status === 'not_authorized') {
		      // The person is logged into Facebook, but not your app.
		      document.getElementById('status').innerHTML = 'Please log ' +
		        'into this app.';
		    } else {
		      // The person is not logged into Facebook, so we're not sure if
		      // they are logged into this app or not.
		      document.getElementById('status').innerHTML = 'Please log ' +
		        'into Facebook.';
		    }
		  }
		
		  // This function is called when someone finishes with the Login
		  // Button.  See the onlogin handler attached to it in the sample
		  // code below.
		  function checkLoginState() {
		    FB.getLoginStatus(function(response) {
		      statusChangeCallback(response);
		    });
		  }
		
		  window.fbAsyncInit = function() {
		  FB.init({
		    appId      : '{your-app-id}',
		    cookie     : true,  // enable cookies to allow the server to access 
		                        // the session
		    xfbml      : true,  // parse social plugins on this page
		    version    : 'v2.2' // use version 2.2
		  });
		
		  // Now that we've initialized the JavaScript SDK, we call 
		  // FB.getLoginStatus().  This function gets the state of the
		  // person visiting this page and can return one of three states to
		  // the callback you provide.  They can be:
		  //
		  // 1. Logged into your app ('connected')
		  // 2. Logged into Facebook, but not your app ('not_authorized')
		  // 3. Not logged into Facebook and can't tell if they are logged into
		  //    your app or not.
		  //
		  // These three cases are handled in the callback function.
		
		  FB.getLoginStatus(function(response) {
		    statusChangeCallback(response);
		  });
		
		  };
		
		  // Load the SDK asynchronously
		  (function(d, s, id) {
		    var js, fjs = d.getElementsByTagName(s)[0];
		    if (d.getElementById(id)) return;
		    js = d.createElement(s); js.id = id;
		    js.src = "//connect.facebook.net/en_US/sdk.js";
		    fjs.parentNode.insertBefore(js, fjs);
		  }(document, 'script', 'facebook-jssdk'));
		
		  // Here we run a very simple test of the Graph API after login is
		  // successful.  See statusChangeCallback() for when this call is made.
		  function testAPI() {
		    console.log('Welcome!  Fetching your information.... ');
		    FB.api('/me', function(response) {
		      console.log('Successful login for: ' + response.name);
		      document.getElementById('status').innerHTML =
		        'Thanks for logging in, ' + response.name + '!';
		    });
		  }
		</script>

	<div class="loginbox unselectable">

		<div class="border-row">
			<form name="loginform" action="" method="post" class="form-signin" role="form">
				<h2 class="form-signin-heading">
					<img src="image/pinderlogo.png" width="50%" height="50%" />
				</h2>
				<input name="user" class="form-control" placeholder="Email address" required="true" type="email" autofocus="true"/> 
				<input type="password" name="pass" class="form-control" placeholder="Password" required="true"/>
				<label class="checkbox pull-left"> 
					<input type="checkbox" name="remember" value="remember-me"/> Remember me
				</label>
				<button class="btn btn-lg btn-primary btn-block" type="submit"
					name="submit">Login</button>
			</form>
			<a href="/createUser.xhtml">Create new user</a>
		</div>

		<div>
		<fb:login-button scope="public_profile,email" onlogin="checkLoginState();">
		</fb:login-button>

		<div id="status">
		</div>
			<a class="button_blue" href="javascript:void(0)" scope="public_profile,email" onclick="checkLoginState();"></a>
		</div>

	</div>

	<div class="pinder_msg">
		<h1>What's Pinder?</h1>
		<span class="msg_small">Pinder is a social discovery site where you find out about what's happening in your community.</span>
	</div>

	<h:form styleClass="googlemapsfull" id="form">
		<m:map height="500px" width="100%" autoReshape="true" enableScrollWheelZoom="true" jsVariable="gmapsMap"
		latitude="1.3000" longitude="103.8000">
<!-- 			latitude="#{query.fromLocationCoordLat}" longitude="#{query.fromLocationCoordLng}" -->
<!-- 				<m:htmlInformationWindow htmlText="#{query.fromLocation}" styleClass="infoBox infoBoxDetails" rendered="#{query.fromLocationCoord != ''}" -->
<!-- 				latitude="#{query.fromLocationCoordLat}" longitude="#{query.fromLocationCoordLng}"  -->
<!-- 				jsVariable="infowindow"/> -->
			<ui:repeat value="#{query.queryResultEventRecord}" var="eaEvent">
				<m:marker latitude="#{eaEvent.eventLocationLat}" longitude="#{eaEvent.eventLocationLng}" showInformationEvent="click">
					<m:htmlInformationWindow htmlText="#{eaEvent.infoBox}" styleClass="infoBox infoBoxDetails"/>
				</m:marker>
			</ui:repeat>
		</m:map>
	</h:form>
		
	<script>
		var geocoder = new google.maps.Geocoder();
		if(typeof infowindow != 'undefined')
			var infowindow = new google.maps.InfoWindow({});
		
		var mapOptions = {
			scrollwheel: false,
			disableDefaultUI: true, // a way to quickly hide all controls
			mapTypeId: google.maps.MapTypeId.ROADMAP
		}
		
		
		function codeAddress(elem) {
		  var address = elem.value;
		  geocoder.geocode( { 'address': address}, function(results, status) {
		    if (status == google.maps.GeocoderStatus.OK) {
		    	  eventAddress = results[0].formatted_address;
		    	  // Escape by javascript first then html
		    	  var htmlInfoWin = results[0].formatted_address
		    	  +"&lt;br\/&gt;&lt;a href=\&quot;javascript:void(0);\&quot; onclick=\&quot;populateForm(this)\&quot;&gt;Use this address&lt;\/a&gt;";
		    	fixMap(results[0].geometry.location, results[0].formatted_address, htmlInfoWin);
		    	
		    	$('#addressLatLngDiv>:input').val(results[0].geometry.location.lat()+","+results[0].geometry.location.lng());
		    	
		    } else {
		    }
		  });
		}
		
		function variableWait(executeFunction){
		    if(typeof gmapsMap !== "undefined"){
		    	executeFunction();
		    }
		    else{
		        setTimeout(function(){
		        	variableWait(executeFunction);
		        },250);
		    }
		}
		variableWait(function() {
				gmapsMap.setOptions(mapOptions);
				google.maps.event.addListener(gmapsMap, 'click', function(event) {
					geocodeAndFixMap(event.latLng);
				});

			}
		);
		
		function geocodeAndFixMap(latLng) {
			geocoder.geocode({'latLng': latLng}, function(results, status) {
			    if (status == google.maps.GeocoderStatus.OK) {
			      if (results[0]) {
						  fixMap(results[0].geometry.location, results[0].formatted_address, results[0].formatted_address);
			      } else {
					// alert('No results found');
			      }
			    } else {
			    }
			});
		}
		
		function populateForm(currentElement) {
			$('#location>:input:nth-child(1)').val(eventAddress);
		}
		
		function fixMap(geocodedLoc, formattedAddress, infoboxHtml) {
			
			  $('#location>:input').val(formattedAddress);
			  $('#locationLatLng>:input').val(geocodedLoc.lat()+","+geocodedLoc.lng());
			
			if(infowindow != null)
				infowindow.setMap(null);

			infowindow = new google.maps.InfoWindow({
				map: gmapsMap,
				position: geocodedLoc,
			    content: infoboxHtml
			});
			
// 			infowindow.open(gmapsMap, marker);
			
// 			gmapsMap.setCenter(geocodedLoc);
			
			var bounds = gmapsMap.getBounds();
			bounds.extend(geocodedLoc);

			gmapsMap.fitBounds(bounds);
			gmapsMap.panToBounds(bounds);
// 			gmapsMap.setZoom(15);
		}
		</script>
	
	<div class="pinder_msg">
		<h1>Find out about what's happening in Singapore:</h1>
	</div>
	<div class="container">
		<img class="img-responsive col-sm-4 col-md-4" src="/image/discoverpanel.png"/>
		<img class="img-responsive col-sm-4 col-md-4" src="/image/searchpanel.png"/>
		<img class="img-responsive col-sm-4 col-md-4" src="/image/createpanel.png"/>
	</div>

	<div class="container activeCategories">
		<div class="headermessage gillsans">
			<h3>Events going on now: [active categories and tags here]</h3>
		</div>
	</div>

		
	<div class="black-bar-comments">
		<h3>Contact us:</h3>
		<div class="center">
		
			<a href="mailto:feedback@pinder.com">feedback@pinder.com</a><br/>
			<br/>
			+65 9784 1134 <br/>
			<br/>
			<address>
				Pinder-plex<br/>
				1 Pinder Lane<br/>
				Singapore(679154)
			</address>
		</div>
	</div>

	<ui:insert name="footer">
	
		<div class="footer">
			<div class="white-bar-footer col-sm-12 col-md-12">
				<center><img src="/image/pinderlogo.png" height="100px" width="300px" /></center>
				<center>
					<div>
						<img src="/image/twittercustom-icon.png" height="36px" width="36px" />
						<img src="/image/facebookcustom-icon.png" height="36px" width="36px" />
						<img src="/image/linkedincustom-icon.png" height="36px" width="36px" />
						<img src="/image/googlepluscustom-icon.png" height="36px" width="36px" />
						<img src="/image/youtubecustom-icon.png" height="36px" width="36px" />
					</div>
				</center>
			</div>
			
			<div class="black-bar-footer col-sm-12 col-md-12">
				(c) Pinder Inc. All Rights Reserved		Privacy | Terms of Use | Services Agreement | Sitemap
			</div>
		</div>
	</ui:insert>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>
    <script src="./js/docs.min.js"></script>
  </body>
</html>
